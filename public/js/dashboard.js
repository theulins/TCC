async function load(){ const r=await fetch('/api/dashboard/metrics',{headers:authHeaders()}); const d=await r.json(); if(!r.ok) return toast(d.error||'Erro'); document.getElementById('kpi').textContent=d.total??0; const list=document.getElementById('recentList'); list.innerHTML=''; (d.recentCompanies||[]).forEach(c=>{ const el=document.createElement('div'); el.textContent=`${c.fantasy_name||'—'} — ${new Date(c.created_date).toLocaleDateString('pt-BR')}`; list.appendChild(el); }); const cty=d.byCity||[]; MicroChart.bar(document.getElementById('chartCities'), cty.map(x=>x.label), cty.map(x=>x.value)); } load();